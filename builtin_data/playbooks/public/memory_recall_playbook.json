{
  "name": "memory_recall",
  "description": "Recall relevant SAIMemory entries and package structured data for meta compose",
  "input_schema": [
    {
      "name": "input",
      "description": "Recall query"
    }
  ],
  "context_requirements": {
    "history_depth": "full",
    "inventory": true,
    "building_items": true,
    "system_prompt": true
  },
  "router_callable": true,
  "nodes": [
    {
      "id": "generate_query",
      "type": "llm",
      "model_type": "lightweight",
      "action": "memory_recallツールの引数を決定します。思い出したい内容を、web検索のクエリのようにスペース区切り等で入力してください。",
      "next": "log",
      "response_schema": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "description": "Optimized search query for memory recall"
          }
        },
        "required": ["query"]
      },
      "output_key": "search_query"
    },
    {
      "id": "log",
      "type": "memorize",
      "action": "{last}",
      "role": "assistant",
      "tags": [
        "tool",
        "memory_recall"
      ],
      "next": "recall"
    },
    {
      "id": "recall",
      "type": "tool",
      "action": "memory_recall",
      "args_input": {
        "query": "search_query.query",
        "max_chars": 10000,
        "topk": 5
      },
      "next": "record"
    },
    {
      "id": "record",
      "type": "memorize",
      "action": "<system>{last}</system>",
      "role": "user",
      "tags": [
        "tool",
        "memory_recall"
      ],
      "next": null
    }
  ],
  "start_node": "generate_query"
}
