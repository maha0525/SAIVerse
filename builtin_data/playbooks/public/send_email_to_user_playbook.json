{
  "name": "send_email_to_user",
  "description": "ユーザーにメールを送れます",
  "input_schema": [
    {
      "name": "input",
      "description": "Request to send a mail to user"
    }
  ],
  "context_requirements": {
    "history_depth": "full",
    "inventory": true,
    "building_items": true,
    "system_prompt": true
  },
  "router_callable": true,
  "nodes": [
    {
      "id": "generate_content",
      "type": "llm",
      "action": "send_email_to_userツールの引数を決定します。送信先のユーザーID、件名、本文を生成してください。（メールアドレスは、ユーザーIDから自動で取得されます）\n\n### 送信可能なユーザー：\nまはー(ユーザーID: 1)",
      "next": "record_response",
      "response_schema": {
        "type": "object",
        "properties": {
          "user_id": {
            "type": "int",
            "description": "送る対象のユーザーID"
          },
          "subject": {
            "type": "string",
            "description": "件名"
          },
          "body": {
            "type": "string",
            "description": "本文。改行してもOK"
          }
        },
        "required": ["user_id", "subject", "body"]
      },
      "output_key": "email_data"
    },
    {
      "id": "record_response",
      "type": "memorize",
      "action": "{email_data}",
      "role": "assistant",
      "tags": [
        "tool",
        "send_email_to_user",
        "conversation"
      ],
      "next": "send"
    },
    {
      "id": "send",
      "type": "tool",
      "action": "send_email_to_user",
      "args_input": {
        "user_id": "email_data.user_id",
        "subject": "email_data.subject",
        "body": "email_data.body"
      },
      "next": "record_result"
    },
    {
      "id": "record_result",
      "type": "memorize",
      "action": "<system>{last}</system>",
      "role": "user",
      "tags": [
        "tool",
        "send_email_to_user",
        "conversation"
      ],
      "next": null
    }
  ],
  "start_node": "generate_content"
}
