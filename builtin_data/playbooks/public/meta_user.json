{
    "name": "meta_user",
    "display_name": "ツール自動使用（1回まで）",
    "description": "Router -> sub-playbook -> speak (exec handled by runtime). Automatically retrieves context from previous autonomous activity.",
    "input_schema": [
        {
            "name": "input",
            "description": "User input",
            "source": null
        }
    ],
    "output_schema": null,
    "router_callable": false,
    "user_selectable": true,
    "nodes": [
        {
            "id": "get_context",
            "type": "tool",
            "action": "get_since_last_user_conversation",
            "args": {
                "include_raw_log": true,
                "max_raw_messages": 10
            },
            "output_key": "autonomous_context",
            "next": "list_playbooks"
        },
        {
            "id": "list_playbooks",
            "type": "tool",
            "action": "list_available_playbooks",
            "args": {},
            "output_key": "available_playbooks",
            "next": "router"
        },
        {
            "id": "router",
            "type": "subplay",
            "playbook": "sub_router_user",
            "input_template": "{input}",
            "propagate_output": false,
            "next": "exec"
        },
        {
            "id": "exec",
            "type": "exec",
            "playbook_source": "selected_playbook",
            "args_source": "selected_args",
            "next": "finalize"
        },
        {
            "id": "finalize",
            "type": "subplay",
            "playbook": "sub_speak",
            "input_template": "{input}",
            "propagate_output": true,
            "next": null
        }
    ],
    "start_node": "get_context"
}
