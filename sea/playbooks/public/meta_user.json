{
  "name": "meta_user",
  "description": "Router -> sub-playbook -> speak (exec handled by runtime)",
  "input_schema": [
    {
      "name": "input",
      "description": "User input"
    }
  ],
  "context_requirements": {
    "history_depth": "full",
    "inventory": true,
    "building_items": true,
    "system_prompt": true
  },
  "router_callable": false,
  "user_selectable": true,
  "nodes": [
    {
      "id": "list_playbooks",
      "type": "tool",
      "action": "list_available_playbooks",
      "args_input": {},
      "output_key": "available_playbooks",
      "next": "router"
    },
    {
      "id": "router",
      "type": "subplay",
      "playbook": "sub_router_user",
      "input_template": "{input}",
      "propagate_output": false,
      "next": "exec"
    },
    {
      "id": "exec",
      "type": "exec",
      "playbook_source": "selected_playbook",
      "args_source": "selected_args",
      "next": "finalize"
    },
    {
      "id": "finalize",
      "type": "subplay",
      "playbook": "sub_speak_meta",
      "input_template": "{input}\n\n参考情報:\n{context_bundle_text}",
      "propagate_output": true,
      "next": null
    }
  ],
  "start_node": "list_playbooks"
}
